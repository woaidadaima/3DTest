<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Three.jså…¨æ™¯å›¾æŸ¥çœ‹å™¨</title>
  <style>
    html,
    body {
      margin: 0;
      height: 100%;
      width: 100%;
      overflow: hidden;
    }

    #c {
      width: 100%;
      height: 100%;
      display: block;
    }

    #lineName {
      display: block;
      color: black;
      font-weight: 700;
      font-size: 128px;
      font-family: Arial, sans-serif;
      user-select: none;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <canvas id="c"></canvas>
  <div id="lineName">å¼ ä¸°666çº¿</div>
</body>
<!-- å¼•å…¥Three.jsæ ¸å¿ƒåº“ -->
<script type="importmap">
    {
      "imports": {
        "three": "./three/build/three.module.js",
        "three/addons/": "./three/examples/jsm/",
        "@tweenjs/tween.js": "./tween.js-main/dist/tween.esm.js"
      }
    }
  </script>
<script type="module">
  import * as THREE from "three";
  import * as TWEEN from "@tweenjs/tween.js";
  import {
    LineModel,
    MarkModel,
    SceneControl,
    PointModel
  } from "./threeDemoJs/index.js"

  // åˆå§‹åŒ–åœºæ™¯æ§åˆ¶å™¨
  const sceneController = new SceneControl({
    camera: {
      fov: 80,
      near: 0.1,
      far: 20000,
      position: { x: 6000, y: 6000, z: 6000 }
    }
  });

  //åˆ›å»ºåœºæ™¯ä¸€æ ‡è®°ç‚¹
  const tagContainer = document.createElement("canvas");
  const markModelConfig = {
    SphereGeometry: {
      geometry: {
        radius: 5,
        widthSegments: 16,
        heightSegments: 16,
      },
      material: {
        color: 0xff0000,
      },
      position: [
        300,
        -172,
        -337,
      ],
      name: "T1",
      animation: {
        axis: "y",
        duration: 2,
        maxDistance: 10
      }
    },
    CircleGeometry: {
      geometry: {
        radius: 5,
        segments: 32,
      },
      material: {
        color: 0xffffff,
        transparent: true,
        side: THREE.DoubleSide
      },
      name: "circle",
      animation: {
        duration: 2,
        maxRadiusRatio: 4,
        initXYZ: [1, 1, 1],
      }
    }
  }
  const markTagConfig = {
    domContainer: tagContainer,
    scale: [40, 20, 5],
    style: {
      width: 256,
      height: 128,
      pixelRatio: window.devicePixelRatio || 1,
      textColor: "white",
      background: "rgba(0, 0, 0, 0.5)",
      fontStyle: "bold 90px Arial",
      textAlign: "center",
      textBaseline: "middle",
      text: "T1",
    }
  }
  const markInstance = new MarkModel(markModelConfig, markTagConfig)

  //åˆ›å»ºåœºæ™¯ä¸€çº¿æ ‡ç­¾å®¹å™¨
  const lineNameLabel = document.getElementById("lineName");
  const lineInstance = new LineModel({
    basicMaterial: {
      color: "#00FF41", // æ›´é²œè‰³çš„ç»¿è‰²
      linewidth: "100", // å¢åŠ çº¿æ¡ç²—ç»†
      transparent: true,
      opacity: 0.9
    },
    dataSource: [
      [- 1128, 414, -2748],
      [570, 445, -2911],
      [1868, 376, -2314],
    ]
  }, {
    domId: lineNameLabel
  })

  //åˆ›å»ºåœºæ™¯ä¸€éšæœºæ ‡è®°ç‚¹
  const pointInstance = new PointModel()
  console.log("ğŸš€ ~ pointInstance:", pointInstance)

  //åˆ›å»ºåœºæ™¯2æ ‡è®°ç‚¹
  const tagContainerScene2 = document.createElement("canvas");
  const markModelConfigScene2 = {
    SphereGeometry: {
      geometry: {
        radius: 5,
        widthSegments: 16,
        heightSegments: 16,
      },
      material: {
        color: 0x00ff00,
      },
      position: [
        -150,
        50,
        400,
      ],
      name: "T2",
      animation: {
        axis: "y",
        duration: 2,
        maxDistance: 10
      }
    },
    CircleGeometry: {
      geometry: {
        radius: 5,
        segments: 32,
      },
      material: {
        color: 0xffffff,
        transparent: true,
        side: THREE.DoubleSide
      },
      name: "circle",
      animation: {
        duration: 2,
        maxRadiusRatio: 4,
        initXYZ: [1, 1, 1],
      }
    }
  }
  const markTagConfigScene2 = {
    domContainer: tagContainerScene2,
    scale: [40, 20, 5],
    style: {
      width: 256,
      height: 128,
      pixelRatio: window.devicePixelRatio || 1,
      textColor: "white",
      background: "rgba(0, 0, 0, 0.5)",
      fontStyle: "bold 90px Arial",
      textAlign: "center",
      textBaseline: "middle",
      text: "T2",
    }
  }
  const markInstanceScene2 = new MarkModel(markModelConfigScene2, markTagConfigScene2)

  // æ·»åŠ åœºæ™¯é…ç½®
  sceneController.addScene('scene1', {
    texture: "./images/DJI_20250228152043_0001_V.JPG",
    markers: markInstance.marksGroup,
    points: pointInstance.points,
    lines: lineInstance.group,
    css3D: true
  });

  sceneController.addScene('scene2', {
    texture: "./images/HMSHå…¨æ™¯_00635_.png",
    markers: markInstanceScene2.marksGroup,
    lines: null,
    css3D: false
  });

  // æ·»åŠ åŠ¨ç”»æ··åˆå™¨
  sceneController.addAnimationMixer(markInstance.mixer);
  sceneController.addAnimationMixer(markInstanceScene2.mixer);
  // åŠ è½½åˆå§‹åœºæ™¯
  sceneController.loadInitialScene('scene1', "./images/DJI_20250228152043_0001_V.JPG");

  // æ·»åŠ ç›¸æœºå…¥åœºåŠ¨ç”»
  sceneController.animateCamera({ x: 0, y: 0, z: 100 }, 6000);

  // å¼€å§‹åŠ¨ç”»å¾ªç¯
  sceneController.startAnimation();
</script>

</html>